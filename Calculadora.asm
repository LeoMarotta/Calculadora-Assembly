OPE EQU 255
OP1 EQU 254
OP2 EQU 253
C EQU 252
R EQU 251

ESPERA: DB 0
UM: DB 1

MENU:
LDI 0
STA C
STA R
IN 01
ADD ESPERA
JZ MENU
IN 00
STA 250
;;;;;;;;;;;;;;;;;;;;;;;;
M:
IN 01
ADD ESPERA
JZ M
IN 00
STA OP1
;;;;;;;;;;;;;;;;;;;;;;;;
N:
IN 01
ADD ESPERA
JZ N
IN 00
STA OP2
;;;;;;;;;;;;;;;;;;;;;;;;
LDA 250
SUB UM
JZ SOMA
SUB UM
JZ SUBT
SUB UM
JZ MUL
SUB UM
JZ DIV
SUB UM
JZ FAT
SUB UM
JZ EXIT
;;;;;;;;;;;;;;;;;;;;;;;;
SOMA:
LDA OP1
ADD OP2
OUT 00
JMP MENU
;;;;;;;;;;;;;;;;;;;;;;;;            
SUBT:
LDA OP1
SUB OP2
OUT 00
JMP MENU
;;;;;;;;;;;;;;;;;;;;;;;;          
MUL:
LDA OP1
JZ RESUL
LDA OP2
JZ RESUL
SUB UM
JZ RESUL3
LDA OP1
SUB UM
JZ RESUL2

FAT2:
LDA OP1      
ADD OP1
STA R
LDA OP2
SUB UM
SUB UM
STA OP2
JN RESUL
JZ RESUL1

LOOP:
LDA R
ADD OP1
STA R
LDA OP2
SUB UM
STA OP2
JZ RESUL1
JMP LOOP

RESUL:
LDA ESPERA
OUT 00
JMP MENU

RESUL1:
LDA C
JNZ LOOP2 
RESULF:
LDA R
OUT 00
JMP MENU

RESUL2:
LDA OP2
OUT 00
JMP MENU
RESUL3:
LDA OP1
OUT 00
JMP MENU
;;;;;;;;;;;;;;;;;;;;;;;;            
DIV:
LDA OP2
JZ RESULD
LDA OP1
JZ RESULD
SUB OP2
STA OP1
JZ RESULD1

LOOP1:
LDA C
ADD UM
STA C
LDA OP1
SUB OP2 
STA OP1
JN RESULD1
JZ RESULD1
JMP LOOP1

RESULD:
LDA C
OUT 00
JMP MENU

RESULD1:
LDA C
ADD UM
OUT 00
JMP MENU
;;;;;;;;;;;;;;;;;;;;;;;;
FAT:
LDA OP1
SUB UM
STA OP2
STA C
JZ RESULF1
JN RESULF1
SUB UM
JZ RESUL3
JMP FAT2
LOOP2:
LDA C
SUB UM
STA C
STA OP2
SUB UM
JZ RESULF
LDA R
STA OP1
JMP FAT2

RESULF1:
LDI 1
OUT 00
JMP MENU

;;;;;;;;;;;;;;;;;;;;;;;;
EXIT:
HLT